---
Tags: [sql,button]
---
use RDSSystem

DECLARE @reportId int = 870
DECLARE @commandButtonColumnId int = 11715

select * from administration.reports where id=@reportId
select * from administration.reportColumns where reportid=@reportId

SELECT 
	StoredProcName = sp.Name 
,	CommandText = rc.Text
,   Expression = rc.Expression
,	ParameterName = spp.Name
,   ReportField = rcb.Sourcefield
,   SQLType = spp.SqlDbType

FROM administration.reportcommands rc
LEFT JOIN administration.StoredProcs sp ON
(
	rc.StoredProcId = sp.id
)
LEFT JOIN administration.StoredProcParams spp ON
(
	spp.storedprocid = sp.id
)
LEFT JOIN administration.ReportCommandBindings rcb ON
(
	rcb.storedprocparamid = spp.id AND
	rcb.reportcommandid   = rc.id
)

WHERE rc.ColumnId = @commandButtonColumnId -- Note 11715 is the columnid of the command button